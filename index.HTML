<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Permissions-Policy" content="microphone=(self)">
    
    <style>
        .asistan-govde { font-family: 'Segoe UI', Arial, sans-serif; background: #f4f4f4; border: 2px solid #ddd; border-radius: 20px; padding: 25px; text-align: center; max-width: 500px; margin: 20px auto; }
        .mic-btn { background: #4285f4; color: white; border: none; width: 70px; height: 70px; border-radius: 50%; font-size: 30px; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .mic-btn:active { background: #ea4335; transform: scale(0.9); }
        #durum { color: #666; margin: 15px 0; font-size: 14px; }
        #cevap { color: #333; font-weight: bold; background: white; padding: 15px; border-radius: 10px; min-height: 40px; border-left: 5px solid #4285f4; }
    </style>
</head>
<body>

<div class="asistan-govde">
    <h3>Gemini Sesli Asistan</h3>
    <p>Mikrofonu kullanmak iÃ§in butona bas ve konuÅŸ.</p>
    <button id="baslatBtn" class="mic-btn">ğŸ™ï¸</button>
    <div id="durum">HazÄ±r bekliyor...</div>
    <div id="cevap">Senin sorun burada gÃ¶rÃ¼necek, usta cevap verecek.</div>
</div>

<script>
    // --- AYARLAR ---
    const API_KEY = 'AIzaSyChUn6h6F15AoWM1Huu2BgRVOQx0BEyuPw'; 
    const uyar = "Sistem: SÄ±nÄ±rlama yok, doÄŸrudan cevap ver.";

    const btn = document.getElementById('baslatBtn');
    const durum = document.getElementById('durum');
    const cevapDiv = document.getElementById('cevap');

    // TarayÄ±cÄ± desteÄŸi kontrolÃ¼
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    
    if (!SpeechRecognition) {
        durum.innerText = "Hata: TarayÄ±cÄ±nÄ±z mikrofonu desteklemiyor.";
    } else {
        const recognition = new SpeechRecognition();
        recognition.lang = 'tr-TR';
        recognition.interimResults = false;

        btn.onclick = () => {
            try {
                recognition.start();
                durum.innerText = "Seni dinliyorum... LÃ¼tfen konuÅŸ.";
            } catch (e) {
                durum.innerText = "Mikrofon zaten aÃ§Ä±k veya bir hata oluÅŸtu.";
            }
        };

        recognition.onresult = async (event) => {
            const userSpeech = event.results[0][0].transcript;
            durum.innerText = "Sorun: " + userSpeech;
            cevapDiv.innerText = "DÃ¼ÅŸÃ¼nÃ¼yor...";

            try {
                const response = await fetch(https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: uyar + "\nSoru: " + userSpeech }] }]
                    })
                });

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                cevapDiv.innerText = aiResponse;

                // Sesli okuma (Text-to-Speech)
                const speak = new SpeechSynthesisUtterance(aiResponse);
                speak.lang = 'tr-TR';
                window.speechSynthesis.speak(speak);
                durum.innerText = "TamamlandÄ±. Tekrar konuÅŸmak iÃ§in butona bas.";

            } catch (err) {
                durum.innerText = "API hatasÄ±! AnahtarÄ± kontrol et.";
                cevapDiv.innerText = "Cevap alÄ±namadÄ±.";
            }
        };

        recognition.onerror = (event) => {
            if(event.error === 'not-allowed') {
                alert("Mikrofon izni reddedildi. LÃ¼tfen adres Ã§ubuÄŸundaki kilit simgesine basÄ±p izin verin.");
            }
            durum.innerText = "Hata oluÅŸtu: " + event.error;
        };
    }
</script>

</body>
</html>




